"use strict";function ownKeys(t,e){var n=Object.keys(t);return Object.getOwnPropertySymbols&&n.push.apply(n,Object.getOwnPropertySymbols(t)),e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n}function _objectSpread(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?ownKeys(n,!0).forEach(function(e){_defineProperty(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):ownKeys(n).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}function _defineProperty(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function _createClass(e,t,n){return t&&_defineProperties(e.prototype,t),n&&_defineProperties(e,n),e}!function(){var e=function(){function t(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};_classCallCheck(this,t),this.actions={},this.listeners=[],this._state=e.initialState||{},this.dev=e.dev,this.dev&&this.listen("*",function(e){console.log(e)}),this.dispatch=this.dispatch.bind(this),this.action=this.action.bind(this),this.listen=this.listen.bind(this)}return _createClass(t,[{key:"action",value:function(e,s){this.actions[e]=function(r,i){return new Promise(function(e,t){var n=s(r,i);n||void 0===n?e(n):t()})}}},{key:"listen",value:function(e,t){var n=this,r={props:"string"==typeof e?[e]:e,fn:t,unsubscribe:function(){var e=n.listeners.indexOf(r);n.listeners.splice(e,1)}};return this.listeners.push(r),r.unsubscribe}},{key:"updateState",value:function(r){var i=this;this._state=_objectSpread({},this._state,{},r);var s=Object.keys(r);this.listeners.forEach(function(e){var t=e.props,n=e.fn;t[0]&&"*"===t[0]?n(r,i._state):0<t.filter(function(e){return s.includes(e)}).length&&n(r,i._state)})}},{key:"dispatch",value:function(t,e){var n=this,r=this.actions[t];if(r)return r(this._state,e||{}).then(function(e){return e?(n.updateState(e),e):{}}).catch(function(e){return console.error("error in action '".concat(t,"'"),e),{}});console.error("no action with name ".concat(t))}}]),t}();"undefined"!=typeof module&&void 0!==module.exports?module.exports=e:window.Juicr=e}();